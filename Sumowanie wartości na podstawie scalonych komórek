function sumujWartosciZKolumnySdoT() {
  const sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();
  const lastRow = sheet.getLastRow();

  // Zakres kolumny T od wiersza 2
  const zakresT = sheet.getRange(2, 20, lastRow - 1); // Kolumna T od wiersza 2
  const mergedRanges = zakresT.getMergedRanges();

  // Najpierw rozliczamy scalone komórki
  mergedRanges.forEach(range => {
    const startRow = range.getRow();
    const numRows = range.getNumRows();

    // Pobierz odpowiednie wartości z kolumny S
    const wartosciS = sheet.getRange(startRow, 19, numRows).getValues();
    const suma = wartosciS.reduce((acc, val) => acc + (parseFloat(val[0]) || 0), 0);

    // Ustaw sumę w pierwszej komórce scalonej grupy w kolumnie T
    sheet.getRange(startRow, 20).setValue(suma);
  });

  // Zbierz wiersze scalone, aby je pominąć później
  const wszystkieScaloneWiersze = new Set();
  mergedRanges.forEach(r => {
    const sr = r.getRow();
    const er = sr + r.getNumRows() - 1;
    for (let i = sr; i <= er; i++) {
      wszystkieScaloneWiersze.add(i);
    }
  });

  // Przejdź przez niescalone wiersze (od 2 do końca)
  for (let row = 2; row <= lastRow; row++) {
    if (!wszystkieScaloneWiersze.has(row)) {
      const valS = sheet.getRange(row, 19).getValue();
      const liczba = parseFloat(valS) || 0;
      sheet.getRange(row, 20).setValue(liczba);
    }
  }
}
